# üöÄ MCP H√çBRIDO - Central de Creadores

## üìã Descripci√≥n

El **MCP H√≠brido para Central de Creadores** es un asistente inteligente que combina herramientas t√©cnicas avanzadas con gu√≠as paso a paso para principiantes. Est√° dise√±ado para:

- üõ°Ô∏è **Proteger tus datos** con backups autom√°ticos y validaciones
- üìö **Documentar todo** autom√°ticamente para mantener el proyecto organizado
- üîç **Analizar inteligentemente** tus solicitudes para darte la mejor gu√≠a
- üöÄ **Migrar de forma segura** de desarrollo local a producci√≥n
- üéØ **Guiar paso a paso** a usuarios principiantes sin asumir conocimientos t√©cnicos

## üéØ **¬øPara Qui√©n es el MCP H√≠brido?**

### ‚úÖ **Para Principiantes (No-Code):**
- No necesitas conocimientos t√©cnicos
- Te gu√≠a paso a paso en todo
- Explica cada acci√≥n antes de hacerla
- Nunca asume informaci√≥n que no tiene
- Hace backup autom√°tico de todo

### ‚úÖ **Para Desarrolladores:**
- Herramientas t√©cnicas avanzadas
- An√°lisis profundo de c√≥digo y base de datos
- Generaci√≥n autom√°tica de componentes y APIs
- Testing y debugging integrado
- Documentaci√≥n autom√°tica

### ‚úÖ **Para Equipos:**
- Documentaci√≥n centralizada y actualizada
- Migraci√≥n guiada entre entornos
- Validaci√≥n de cambios antes de ejecutar
- Historial completo de modificaciones
- Base de conocimiento compartida

## üéØ Caracter√≠sticas Principales

### üõ°Ô∏è **Herramientas de Seguridad (NUEVAS)**
- **Backup autom√°tico**: Crea backups antes de cualquier cambio
- **Validaci√≥n de cambios**: Verifica impacto antes de ejecutar
- **Gu√≠a paso a paso**: Te acompa√±a en cada proceso
- **Protecci√≥n de datos**: Nunca modifica sin confirmaci√≥n

### üé® **Herramientas del Sistema de Dise√±o (NUEVAS)**
- **An√°lisis del sistema**: Revisa colores, componentes y estructura
- **Validaci√≥n de colores**: Verifica consistencia con el sistema
- **Documentaci√≥n autom√°tica**: Registra nuevos componentes
- **Paleta de colores**: Actualiza y mantiene colores
- **Cumplimiento de dise√±o**: Verifica reglas del sistema
- **Tokens de dise√±o**: Genera tokens CSS autom√°ticamente
- **Estructura de componentes**: Valida mejores pr√°cticas
- **Accesibilidad WCAG**: Analiza seg√∫n est√°ndares AA
- **Modos claro/oscuro**: Optimiza para ambos temas
- **Mejoras propuestas**: Sugiere optimizaciones espec√≠ficas

### üìã **Herramientas de An√°lisis Inteligente (NUEVAS)**
- **An√°lisis de solicitudes**: Entiende lo que necesitas
- **Verificaci√≥n de documentaci√≥n**: Busca informaci√≥n existente
- **Solicitud de datos**: Pide informaci√≥n cuando no la tiene
- **No asume nada**: Siempre pregunta si no est√° seguro

### üìö **Herramientas de Documentaci√≥n Autom√°tica (NUEVAS)**
- **Documentaci√≥n centralizada**: Mantiene todo organizado
- **Actualizaci√≥n autom√°tica**: Registra cambios autom√°ticamente
- **Base de conocimiento**: Busca y actualiza informaci√≥n
- **Historial completo**: Mantiene registro de todo

### üöÄ **Herramientas de Migraci√≥n Guiada (NUEVAS)**
- **Migraci√≥n local a nube**: Gu√≠a completa paso a paso
- **Scripts de migraci√≥n**: Genera y ejecuta scripts seguros
- **Validaci√≥n post-migraci√≥n**: Verifica que todo funcione
- **Rollback disponible**: Puede revertir si algo sale mal

### üîß **Herramientas de Base de Datos (MEJORADAS)**
- **An√°lisis de estructura**: Verificaci√≥n completa de tablas, columnas y relaciones
- **Gesti√≥n de datos**: Inserci√≥n, actualizaci√≥n y backup de datos
- **Vistas y triggers**: Creaci√≥n y mantenimiento de vistas y triggers autom√°ticos
- **Diagn√≥stico**: Detecci√≥n de problemas comunes en la estructura de BD
- **Documentaci√≥n de tablas**: Registra estructura autom√°ticamente
- **Pol√≠ticas RLS**: Documenta y verifica pol√≠ticas de seguridad

### üé® **Herramientas de Desarrollo Frontend**
- **An√°lisis de componentes**: Verificaci√≥n de estructura de componentes React
- **Generaci√≥n de c√≥digo**: Creaci√≥n autom√°tica de componentes, tipos y endpoints
- **Verificaci√≥n de tipos**: An√°lisis de tipos TypeScript y dependencias
- **Testing**: Ejecuci√≥n de tests y debugging de c√≥digo

### üìä **Herramientas de API**
- **Verificaci√≥n de endpoints**: An√°lisis de estructura y funcionalidad de APIs
- **Generaci√≥n de endpoints**: Creaci√≥n autom√°tica de endpoints REST
- **Testing de APIs**: Pruebas automatizadas de endpoints

### üìö **Herramientas de Documentaci√≥n (MEJORADAS)**
- **Generaci√≥n de documentaci√≥n**: Creaci√≥n autom√°tica de documentaci√≥n t√©cnica
- **Base de conocimiento**: Actualizaci√≥n de la KB del proyecto
- **Logs de migraci√≥n**: Documentaci√≥n de cambios en la base de datos
- **Entradas de conocimiento**: Crea y actualiza informaci√≥n
- **B√∫squeda inteligente**: Encuentra informaci√≥n r√°pidamente

## üõ†Ô∏è Instalaci√≥n

### Prerrequisitos
- Node.js >= 18.0.0
- npm >= 8.0.0
- Acceso a Supabase (URL y API keys)

### Configuraci√≥n

1. **Clonar el repositorio**:
```bash
git clone https://github.com/central-de-creadores/mcp-server.git
cd mcp-server
```

2. **Instalar dependencias**:
```bash
npm install
```

3. **Configurar variables de entorno**:
```bash
cp .env.example .env
```

Editar `.env` con tus credenciales de Supabase:
```env
SUPABASE_URL=tu_url_de_supabase
SUPABASE_ANON_KEY=tu_anon_key
SUPABASE_SERVICE_ROLE_KEY=tu_service_role_key
```

4. **Configurar MCP en tu cliente**:
```json
{
  "mcpServers": {
    "central-de-creadores": {
      "command": "node",
      "args": ["central-de-creadores-mcp.js"],
      "env": {
        "SUPABASE_URL": "${SUPABASE_URL}",
        "SUPABASE_ANON_KEY": "${SUPABASE_ANON_KEY}",
        "SUPABASE_SERVICE_ROLE_KEY": "${SUPABASE_SERVICE_ROLE_KEY}"
      }
    }
  }
}
```

## üéÆ Uso

### Herramientas Disponibles

#### üîç An√°lisis de Base de Datos

**`analyze_database_structure`**
```json
{
  "table_name": "investigaciones"
}
```

**`verify_table_structure`**
```json
{
  "table_name": "usuarios",
  "expected_columns": ["id", "nombre", "correo", "activo"]
}
```

**`check_foreign_keys`**
```json
{
  "table_name": "reclutamientos"
}
```

#### üìù Gesti√≥n de Datos

**`execute_sql_query`**
```json
{
  "sql_query": "SELECT * FROM investigaciones WHERE estado = 'en_progreso'",
  "description": "Obtener investigaciones en progreso"
}
```

**`insert_test_data`**
```json
{
  "table_name": "participantes",
  "data": {
    "nombre": "Juan P√©rez",
    "rol_empresa_id": "uuid-here",
    "empresa_id": "uuid-here"
  },
  "description": "Insertar participante de prueba"
}
```

#### üé® Generaci√≥n de C√≥digo

**`generate_component`**
```json
{
  "component_name": "InvestigacionCard",
  "component_type": "functional",
  "props": ["investigacion", "onEdit", "onDelete"],
  "description": "Componente para mostrar tarjeta de investigaci√≥n"
}
```

**`generate_api_endpoint`**
```json
{
  "endpoint_name": "investigaciones",
  "method": "GET",
  "table_name": "investigaciones",
  "operations": ["list", "filter", "search"],
  "description": "Endpoint para gestionar investigaciones"
}
```

#### üìä Testing y Debugging

**`run_tests`**
```json
{
  "test_type": "unit"
}
```

**`debug_sql_query`**
```json
{
  "sql_query": "SELECT * FROM vista_reclutamientos_completa LIMIT 5",
  "table_name": "reclutamientos",
  "expected_result": {
    "row_count": 5,
    "has_data": true
  }
}
```

## üèóÔ∏è Arquitectura del Proyecto

### Estructura de Base de Datos

#### Tablas Principales
- **`usuarios`**: Usuarios del sistema (correo, nombre, rol_plataforma)
- **`investigaciones`**: Investigaciones de usuarios (nombre, estado, fechas)
- **`participantes`**: Participantes externos (nombre, rol_empresa_id, empresa_id)
- **`participantes_internos`**: Participantes internos (nombre, email, rol_empresa_id)
- **`reclutamientos`**: Relaci√≥n investigaciones-participantes
- **`empresas`**: Clientes y empresas participantes
- **`libretos_investigacion`**: Libretos de investigaci√≥n

#### Vistas Importantes
- **`vista_reclutamientos_completa`**: Vista principal para reclutamientos
- **`vista_investigaciones_con_usuarios`**: Investigaciones con datos de usuarios

#### Triggers Autom√°ticos
- **Trigger de estados**: Actualiza autom√°ticamente estados de reclutamiento
- **Trigger de libretos**: Crea reclutamientos autom√°ticamente

### Estructura Frontend

#### Componentes Principales
- **`CrearReclutamientoModal`**: Modal principal de reclutamiento
- **`CrearParticipanteInternoModal`**: Modal para participantes internos
- **`CrearParticipanteExternoModal`**: Modal para participantes externos
- **`InvestigacionCard`**: Tarjeta de investigaci√≥n
- **`DataTable`**: Tabla de datos reutilizable

#### Tipos TypeScript
- **`investigaciones.ts`**: Tipos para m√≥dulo de investigaciones
- **`reclutamientos.ts`**: Tipos para m√≥dulo de reclutamiento
- **`libretos.ts`**: Tipos para libretos de investigaci√≥n
- **`usuarios.ts`**: Tipos para usuarios del sistema

## üîß Configuraci√≥n Avanzada

### Variables de Entorno

```env
# Supabase
SUPABASE_URL=https://your-project.supabase.co
SUPABASE_ANON_KEY=your-anon-key
SUPABASE_SERVICE_ROLE_KEY=your-service-role-key

# Desarrollo
NODE_ENV=development
DEBUG=true

# Logging
LOG_LEVEL=info
```

### Configuraci√≥n de RLS

El MCP incluye herramientas para gestionar Row Level Security (RLS):

```sql
-- Ejemplo de pol√≠tica RLS
CREATE POLICY "Usuarios pueden ver sus propios datos" ON usuarios
FOR SELECT USING (auth.uid() = id);
```

## üß™ Testing

### Ejecutar Tests
```bash
# Tests unitarios
npm test

# Tests con coverage
npm run test:coverage

# Tests espec√≠ficos
npm test -- --testNamePattern="database"
```

### Debugging
```bash
# Modo debug
DEBUG=true npm start

# Logs detallados
LOG_LEVEL=debug npm start
```

## üìö Documentaci√≥n

### Generar Documentaci√≥n
```json
{
  "module_name": "reclutamiento",
  "documentation_type": "api",
  "content": "Documentaci√≥n del m√≥dulo de reclutamiento..."
}
```

### Actualizar Base de Conocimiento
```json
{
  "change_type": "table_modification",
  "entity_name": "participantes",
  "new_structure": {
    "columns": ["id", "nombre", "email", "rol_empresa_id"]
  },
  "description": "Agregada columna email a participantes"
}
```

## üö® Troubleshooting

### Problemas Comunes

#### Error de Conexi√≥n a Supabase
```
Error: Variables de entorno de Supabase no configuradas
```
**Soluci√≥n**: Verificar que las variables de entorno est√©n configuradas correctamente.

#### Error de Permisos
```
Error: permission denied for table
```
**Soluci√≥n**: Verificar pol√≠ticas RLS y permisos de usuario.

#### Error de Tipos TypeScript
```
Error: Type 'X' is not assignable to type 'Y'
```
**Soluci√≥n**: Usar `analyze_typescript_types` para verificar tipos.

### Logs y Debugging

El MCP incluye logging detallado:

```bash
# Ver logs en tiempo real
tail -f mcp-server.log

# Filtrar logs por herramienta
grep "analyze_database_structure" mcp-server.log
```

## ü§ù Contribuci√≥n

### Desarrollo Local

1. **Fork del repositorio**
2. **Crear rama de feature**: `git checkout -b feature/nueva-herramienta`
3. **Implementar cambios**
4. **Ejecutar tests**: `npm test`
5. **Crear pull request**

### Est√°ndares de C√≥digo

- **ESLint**: Configuraci√≥n incluida
- **Prettier**: Formateo autom√°tico
- **TypeScript**: Tipos estrictos
- **Jest**: Tests unitarios

### Agregar Nuevas Herramientas

1. **Definir en `mcp-tools.json`**
2. **Implementar en `central-de-creadores-mcp.js`**
3. **Agregar tests**
4. **Actualizar documentaci√≥n**

## üìÑ Licencia

MIT License - ver [LICENSE](LICENSE) para detalles.

## üÜò Soporte

- **Issues**: [GitHub Issues](https://github.com/central-de-creadores/mcp-server/issues)
- **Documentaci√≥n**: [Wiki del proyecto](https://github.com/central-de-creadores/mcp-server/wiki)
- **Discord**: [Servidor de la comunidad](https://discord.gg/central-de-creadores)

## üîÑ Changelog

### v1.0.0 (2025-01-20)
- ‚ú® Implementaci√≥n inicial del MCP Server
- üîß Herramientas de an√°lisis de base de datos
- üé® Herramientas de generaci√≥n de c√≥digo
- üìä Herramientas de testing y debugging
- üìö Herramientas de documentaci√≥n

---

**Desarrollado con ‚ù§Ô∏è por el equipo de Central de Creadores** 